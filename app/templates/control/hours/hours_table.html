{% extends "control/base.html" %}

{% block title %}Ввод трудоемкости{% endblock title %}

{% block content %}
    <div class="content-section">
        <div class="tabs">
            <form method="GET" action="{{ url_for('control.hours.hours_table') }}">
                <button class="tab-button active"><i class="fas fa-list"></i>Список часов</button>
            </form>
            <form method="GET" action="{{ url_for('control.hours.add_hours') }}">
                <button class="tab-button"><i class="fas fa-plus"></i>Внести трудоемкость</button>
            </form>
        </div>

        <table>
            <thead>
                <tr>
                    <th style="width: 5%;">&numero;</th>
                    <th style="width: 15%;">Номер заказа</th>
                    <th style="width: 45%;">Наименование работы</th>
                    <th style="width: 25%;">Фактическая трудоемкость</th>
                    <th style="width: 10%;">Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for hours_id, order_id, work_name, spent_hours in hours_list %}
                    {% set page = page | default(1) %}
                    {% set page_size = 10 %}
                    <tr>
                        <td>{{ loop.index + (page - 1) * page_size }}</td>
                        <td>{{ order_id }}</td>
                        <td>{{ work_name }}</td>
                        <td>{{ spent_hours }}</td>
                        <td class="actions-container">
                            {# <form method="GET" action="#">
                                <button type="submit" class="icon-button edit-button tooltip">
                                    <i class="fas fa-edit"></i>
                                    <span class="tooltiptext">Редактировать часы</span>
                                </button>
                            </form> #}
                            <form method="POST" action="{{ url_for('control.hours.delete_hours', hours_id=hours_id) }}">
                                {# <input type="hidden" name="page" value="{{ page }}"> #}
                                <button type="submit" class="icon-button delete-button tooltip" data-action="delete-hours">
                                    <i class="fas fa-trash"></i>
                                    <span class="tooltiptext">Удалить часы</span>
                                </button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        {# <div class="section">
            <div class="pagination-container">
                {% set page = page | default(0) %}
                {% set page_size = 10 %}
                {% set total_hours = hours_list | length %}
                {% set total_pages = (total_hours + page_size - 1) // page_size %}
                {% if page == 1 %}
                    <span class="pagination-arrow" style="visibility: hidden;"><i class="fas fa-angle-left"></i></span>
                {% endif %}
                {% if page > 1 %}
                    {% set previous_page = page - 1 %}
                    <a href="{{ url_for('control.hours.hours_table', page=previous_page) }}" class="pagination-arrow">
                        <i class="fas fa-angle-left"></i>
                    </a>
                {% endif %}
                <span>Страница {{ page }} / {{ total_pages }}</span>
                {% if page < total_pages %}
                    {% set next_page = page + 1 %}
                    <a href="{{ url_for('control.hours.hours_table', page=next_page) }}" class="pagination-arrow">
                        <i class="fas fa-angle-right"></i>
                    </a>
                {% endif %}
                {% if page == total_pages %}
                    <span class="pagination-arrow" style="visibility: hidden;"><i class="fas fa-angle-right"></i></span>
                {% endif %}
            </div>
        </div> #}
    </div>
{% endblock content %}
